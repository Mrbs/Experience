    本发明涉及一种供暖管网的动态平衡方法及系统，其方法包括：确定管网单元内每一节点的现实流量分布；将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点；调节最有利节点和最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的动态平衡。其系统利用了这一方法。本发明实现了流量的自动调节，可以减少在供暖调节初期人工管网调节的劳动强度，同时在不增加上级管网配比流量的情况下，在子管网内部进行区域性调配，达到节约热网资源的效果。
    1、一种供暖管网的动态平衡方法，其特征在于，包括：
步骤1、确定管网单元内每一节点的现实流量分布；
步骤2、将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点，流量最有利节点的现实流量大于正常流量，流量最不利节点的现实流量小于正常流量；
步骤3、调节流量最有利节点和流量最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的流量动态平衡。
2、根据权利要求1所述的供暖管网的动态平衡方法，其特征在于，在所述步骤3中，在调节流量最有利节点和流量最不利节点的流量之后，所述方法还包括：
步骤3′、等待预定时间间隔，再次执行所述步骤1和步骤2、并再次调节流量最有利节点和流量最不利节点的流量；
在供暖周期内，循环执行所述步骤3′。
3、根据权利要求1或2所述的供暖管网的动态平衡方法，其特征在于：
在执行所述步骤3之后，若不存在流量最不利节点，则执行步骤4′，减少所述管网单元的总流量供应；
在执行所述步骤3之后，若不存在流量最有利节点，则执行步骤5′，增加所述管网单元的总流量供应。
4、根据权利要求2所述的供暖管网的动态平衡方法，其特征在于：在执行所述步骤3′之后，将执行所述步骤3′之后获得的各节点的流量数据、及与该流量数据对应的阀门开度数据写入数据库。
5、根据权利要求2所述的供暖管网的动态平衡方法，其特征在于，在执行所述步骤3或所述步骤3′之后，所述方法还包括：
步骤4、在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。
6、根据权利要求5所述的供暖管网的动态平衡方法，其特征在于，所述步骤4具体包括：
步骤41、确定管网单元内每一节点的现实温度分布，将每个节点的现实温度与市政标准温度相比较，确定管网单元内的温度最有利节点和温度最不利节点，温度最有利节点的现实温度高于市政标准温度，温度最不利节点的现实温度低于市政标准温度；
步骤42、依次关断管网单元内的全部或部分节点，确定在保证一个节点的市政标准温度的前提下该节点在预定周期内可被关断的最长时间，并确定一个节点关断后其它节点达到市政标准温度时所需的最短时间；
步骤43、依据所述最短时间，选择包含所述温度最有利节点和温度最不利节点的耗时最短路径，并依据所述耗时最短路径确定节点关断方案，以使所述温度最不利节点达到温度动态平衡。
7、根据权利要求6所述的供暖管网的动态平衡方法，其特征在于，在所述步骤41和步骤42之间，所述步骤4还包括：
步骤41′、依次关断管网单元内的各节点，确定一个节点关断后对其它节点的流量补偿比重，选择具有特定流量补偿比重的节点作为步骤42中的所述部分节点。
8、根据权利要求6或7所述的供暖管网的动态平衡方法，其特征在于，所述步骤43具体包括：
步骤431、将所述温度最有利节点纳入所述耗时最短路径中；
步骤432、在所述最短时间中选择以所述温度最有利节点作为始端的最小时间路径，并将该路径纳入所述耗时最短路径中；
步骤433、选择与已经纳入到所述耗时最短路径中的节点相通的、且不与已经纳入到所述耗时最短路径中的路径构成闭合回路的最小时间路径，并将该路径纳入所述耗时最短路径中；
步骤434、当所述最不利节点被纳入到所述耗时最短路径中之后，结束选择；
步骤435、在与所述耗时最短路径包含的各节点对应的所述最长时间内，同时关断相应的节点。
9、一种供暖管网的动态平衡系统，其特征在于，一个管网单元包括多个节点，所述系统包括：
热表，在每个节点处设置一个热表，所述热表电连接至管网动态平衡控制器，并用于采集对应节点的流量数据；
阀门，在每个节点处设置一个阀门，所述阀门连接在供水管路上，并且所述阀门电连接至所述管网动态平衡控制器，并根据所述管网动态平衡控制器的指令控制自身的开度；
管网动态平衡控制器，包括流量动态平衡控制单元，所述流量动态平衡控制单元与热表和阀门电连接。
10、根据权利要求9所述的供暖管网动态平衡系统，其特征在于，所述系统还包括总阀门，所述总阀门与所述管网动态平衡控制器电连接，用于增加或减少所述管网单元的总流量。
11、根据权利要求9所述的供暖管网动态平衡系统，其特征在于，所述系统还包括网络集中交换机，所述网络集中交换机与所述管网动态平衡控制器通过网络连接，接收并保存所述管网动态平衡控制器控制的各节点流量数据和阀门开度数据。
12、根据权利要求9所述的供暖管网动态平衡系统，其特征在于，所述系统还包括温控器，所述管网动态平衡控制器还包括温度动态平衡控制单元，所述温度动态平衡控制单元与所述温控器和所述阀门电连接，所述温控器用于采集对应节点的温度数据，所述温度动态平衡控制单元用于在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。

 
供暖管网的动态平衡方法及系统
技术领域
    本发明涉及供暖管网的平衡调节技术领域，具体涉及一种供暖管网的动态平衡方法及系统。
背景技术
我国的北方城市供暖大多数都采用集中供暖方式。随着经济的迅猛发展和城市化水平的提高，供热管网分布面积越来越大，热用户数量也急剧增长。为此，如何满足用户需求，提高供暖品质，已成为当前供暖企业重点关注的问题。
在供热系统中，水力平衡调节是一个关键，对供热效率以及对环境有着至关重要的影响，但是在实际的供热运行中，受环境温度、房屋位置及保温结构等因素的影响，用户的用热需求也不尽相同，如按照统一标准进行管网流量分配，将导致用户之间冷热不均，管网水力失衡。
而本发明人凭借多年从事相关行业的经验与实践，提出一种供暖管网的动态平衡方法及系统，以克服现有的技术缺陷。
发明内容
本发明针对上述现有技术存在的问题，为了满足在供暖管网内部动态平衡的需要，提供了一种供暖管网的动态平衡方法及系统。
一方面，本发明实施例提供了一种供暖管网的动态平衡方法，包括：步骤1、确定管网单元内每一节点的现实流量分布；步骤2、将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点，流量最有利节点的现实流量大于正常流量，流量最不利节点的现实流量小于正常流量；步骤3、调节流量最有利节点和流量最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的流量动态平衡。
为了达到更好的调节效果，在所述步骤3中，在调节流量最有利节点和流量最不利节点的流量之后，所述方法还包括：步骤3′、等待预定时间间隔，再次执行所述步骤1和步骤2、并再次调节流量最有利节点和流量最不利节点的流量；在供暖周期内，循环执行所述步骤3′。
在一些情况下，上一级管网为管网单元分配的流量过多或不足，在管网单元内进行动态平衡时应考虑这一因素，具体操作为：在执行所述步骤3之后，若不存在流量最不利节点，则执行步骤4′，减少所述管网单元的总流量供应；在执行所述步骤3之后，若不存在流量最有利节点，则执行步骤5′，增加所述管网单元的总流量供应。
 作为对上述技术方案的改进，在执行所述步骤3′之后，将执行所述步骤3′之后获得的各节点的流量数据、及与该流量数据对应的阀门开度数据写入数据库。
作为对上述技术方案的另一种改进，在执行所述步骤3或所述步骤3′之后，所述方法还包括：步骤4、在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。
其中，步骤4具体包括：步骤41、确定管网单元内每一节点的现实温度分布，将每个节点的现实温度与市政标准温度相比较，确定管网单元内的温度最有利节点和温度最不利节点，温度最有利节点的现实温度高于市政标准温度，温度最不利节点的现实温度低于市政标准温度；步骤42、依次关断管网单元内的全部或部分节点，确定在保证一个节点的市政标准温度的前提下该节点在预定周期内可被关断的最长时间，并确定一个节点关断后其它节点达到市政标准温度时所需的最短时间；步骤43、依据所述最短时间，选择包含所述温度最有利节点和温度最不利节点的耗时最短路径，并依据所述耗时最短路径确定节点关断方案，以使所述温度最不利节点达到温度动态平衡。
在具体操作中，由于一个管网单元内的节点往往较多，因此可以在步骤41和步骤42之间执行步骤41′，以便在步骤42中仅依次关断管网单元内的部分节点，节省试验时间。步骤41′为：依次关断管网单元内的各节点，确定一个节点关断后对其它节点的流量补偿比重，选择具有特定流量补偿比重的节点作为步骤42中的所述部分节点。
步骤43的具体操作方法为：步骤431、将所述温度最有利节点纳入所述耗时最短路径中；步骤432、在所述最短时间中选择以所述温度最有利节点作为始端的最小时间路径，并将该路径纳入所述耗时最短路径中；步骤433、选择与已经纳入到所述耗时最短路径中的节点相通的、且不与已经纳入到所述耗时最短路径中的路径构成闭合回路的最小时间路径，并将该路径纳入所述耗时最短路径中；步骤434、当所述最不利节点被纳入到所述耗时最短路径中之后，结束选择；步骤435、在与所述耗时最短路径包含的各节点对应的所述最长时间内，同时关断相应的节点。
另一方面，本发明实施例还提供了一种供暖管网的动态平衡系统，其中一个管网单元包括多个节点，所述系统包括：热表，在每个节点处设置一个热表，所述热表电连接至管网动态平衡控制器，并用于采集对应节点的流量数据；阀门，在每个节点处设置一个阀门，所述阀门连接在供水管路上，并且所述阀门电连接至所述管网动态平衡控制器，并根据所述管网动态平衡控制器的指令控制自身的开度；管网动态平衡控制器，包括流量动态平衡控制单元，所述流量动态平衡控制单元与热表和阀门电连接，用于：确定管网单元内每一节点的现实流量分布；将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点，其中，流量最有利节点的现实流量大于正常流量，流量最不利节点的现实流量小于正常流量；调节流量最有利节点和流量最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的流量动态平衡。
所述系统还包括总阀门，所述总阀门与所述管网动态平衡控制器电连接，用于增加或减少所述管网单元的总流量。
此外，上述供暖管网动态平衡系统还包括：网络集中交换机，所述网络集中交换机与所述管网动态平衡控制器通过网络连接，接收并保存所述管网动态平衡控制器控制的各节点流量数据和阀门开度数据。
作为对上述供暖管网动态平衡系统的一种改进，所述系统还包括温控器，所述管网动态平衡控制器还包括温度动态平衡控制单元，所述温度动态平衡控制单元与所述温控器和所述阀门电连接，所述温控器用于采集对应节点的温度数据，所述温度动态平衡控制单元用于在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。
本发明提供的供暖管网动态平衡方法及系统能够达到如下效果，通过首先鉴别最有利节点和最不利节点，并据此调节最有利节点和最不利节点的阀门开度，实现了流量的自动调节，可以减少在供暖调节初期人工管网调节的劳动强度，同时在不增加上级管网配比流量的情况下，在子管网内部进行区域性调配，而不是按照统一标准进行管网流量分配，因此可以达到流量动态平衡的效果，并进而达到节约热网资源的效果。
附图说明
图1为本发明实施例1提供的供暖管网动态平衡方法的示意图；
图2为本发明实施例2提供的供暖管网动态平衡方法的示意图；
图3为本发明实施例2提供的供暖管网动态平衡方法中各节点之间的拓扑结构图；
图4为本发明实施例提供的供暖管网动态平衡系统的示意图；
图5为图4所示供暖管网动态平衡系统的实际布置的示例图。
附图标记：
401-热表、402-温控器、403-阀门；
420-管网动态平衡控制器、421-流量动态平衡控制单元、422-温度动态平衡控制单元；
430-总阀门；
440-网络集中交换机。
具体实施方式
为使本发明的目的、技术方案和优点更加清楚，下面将结合附图及具体实施例对本发明作进一步地详细描述。
实施例1：
如图1所示，本发明实施例1提供的供暖管网的动态平衡方法包括：
    步骤1、确定管网单元内每一节点的现实流量分布；
在本发明的实施例中，管网即供暖管网，管网单元是由多个节点组成的。例如：以一个小区作为管网单元时，该小区内的各楼栋将被视为节点；以一个楼栋作为管网单元时，该楼栋内的各户将被视为节点；以一户作为管网单元时，该户内的各个房间将被视为节点。并且，管网单元和节点的划分并不局限于此，在一些情形下，也可以将小区作为管网单元，将该小区内的各户视为节点。
确定管网单元内每一节点的现实流量的方法很多，较直接的方法是收集各个节点的热表反馈的流量数据，再根据各个节点的流量数据获取该管网单元内各节点的现实流量分布。
步骤2、将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点，流量最有利节点的现实流量大于正常流量，流量最不利节点的现实流量小于正常流量；
每个节点的现实流量即热表监测并反馈的实际流量数据，每个节点的正常流量即根据该节点的供热需求计算得出的理论流量数据。例如，由于各个节点的供热面积、设定温度等不同，因此各个节点的供热需求也不相同，这就导致一些节点的正常流量较大、而另一些节点的正常流量较小。
将每个节点的现实流量与正常流量相比较，例如可以使二者相减或者使二者相除，这样可以得到一个比较值。相减时该比较值大于0且最大者、或相除时该比较值大于1且最大者将作为流量最有利节点，因为该节点的现实流量与其正常流量相比最大，即该节点本来需要的流量较小，但实际情况却是为该节点供给了更多的流量，这样有一部分流量就浪费了。相减时上述比较值小于0且最小者、或相除时上述比较值小于1且最小者将作为流量最不利节点，因为该节点的现实流量与其正常流量相比最小，即该节点本来需要较多的流量，但实际情况却是没有为其供给足够的流量，使其供暖达不到标准要求。
步骤3、调节流量最有利节点和流量最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的流量动态平衡。
最直接的调节流量最有利节点和流量最不利节点流量的方法是，调节与节点对应的电动阀门的开度。对于流量最有利节点，可以减小其电动阀门的开度，使为其供应的现实流量减少。对于流量最不利节点，可以增大其电动阀门的开度，使为供应的现实流量增大。或者，也可以仅减小流量最有利节点的电动阀门开度，这样节省出的流量就可以补偿至流量最不利节点。
但是在一个管网单元中往往存在多个节点，减小最有利节点的电动阀门开度之后，由于其他节点的存在，最有利节点的流量减小之后也会使其他节点的流量产生不同程度的增大，因此最不利节点的流量并不会随之呈线性增大，即有的时候单纯依靠该实施例1提供的方法，有可能无法达到供暖管网动态平衡的效果。此时，可以使用本发明实施例2提供的方法继续进行调节。该实施例2将在下文中详细介绍。
在实施例1中，一次选择一个流量最有利节点进行调节，可以避免同时调小多个节点的流量时对管网的冲击，因为各个节点是串行设置的，同时调小多个节点的流量会使得其它节点阀门的流量增大，从而使得媒介压力增大，当材料强度达不到要求时，还会使阀门爆开。
对于本实施例1而言，在所述步骤3中，在调节流量最有利节点和流量最不利节点的流量之后，所述方法还可以包括：步骤3′、等待预定时间间隔，再次执行所述步骤1和步骤2、并再次调节流量最有利节点和流量最不利节点的流量。也就是说，通过一次调节之后，流量最有利节点和流量最不利节点的分布有可能会产生变化。即，将流量最有利节点的电动阀门开度减小之后，该流量最有利节点的流量随之减小，有可能不再是最有利节点。基于同样的道理，流量最不利节点也可能会发生变化。
因此，为了在整个管网单元内达到动态的平衡，需要在整个供暖期间，循环执行所述步骤3′。其中，上述预定的时间间隔可以根据实际情况进行选择，也可以将该事件间隔设置为0，此时表明上述步骤3′的循环执行一直在不断进行。
这里应该注意的是，在本实施例1中，上述的步骤3′并不是必须的步骤，同样循环执行步骤3′也不是必须的。只是在大部分情况下，都需要进行多次调节才可以达到管网单元内的动态平衡。但这并不排除仅通过一次调节即可达到动态平衡的情况。
在本实施例1中，还需要说明的是：若相减得到的上述比较值全都大于等于0或相除得到的上述比较值全都大于等于1，则该管网单元内不存在最不利节点，此时说明整个管网单元的流量供应可能过剩，应执行步骤4′，减少该管网单元的总流量供应；若相减得到的上述比较值全都小于等于0或相除得到的上述比较值全都小于等于1，则该管网单元内不存在最有利节点，此时说明整个管网单元的流量供应可能不足，应执行步骤5′，增加该管网单元的总流量供应。
进一步地，作为对本实施例1的改进，在执行所述步骤3′，还可以将执行所述步骤3′之后获得的各节点的流量数据、及与该流量数据对应的阀门开度数据写入数据库。数据库中的数据可以直接调用，这样当由于室外温度变化等因素使得当前的流量和阀门开度不能达到管网单元的流量动态平衡时，可以利用数据库中记录的历史数据对管网单元的流量和阀门开度进行设置，以便减少重新调节平衡所需要的时间。例如，在数据库中记录了室外温度为-5℃时达到流量动态平衡时的流量数据和阀门开度数据后，如果室外温度经过回升至0℃以上后又降至-6℃时，可以首先调用-5℃情况下达到流量动态平衡时的流量数据和阀门开度数据，之后再由管网单元自身根据实施例1介绍的方法调节至-6℃情况下的流量动态平衡，这样可以节省管网单元自身调节所需的时间。最后，可以将-6℃情况下达到流量动态平衡的流量数据和阀门开度数据记录到数据库中。
依据本实施例1提供的方法，通过首先鉴别最有利节点和最不利节点，并据此调节最有利节点和最不利节点的阀门开度，实现了流量的自动调节，可以减少在供暖调节初期人工管网调节的劳动强度，同时在不增加上级管网配比流量的情况下，在子管网内部进行区域性调配，而不是按照统一标准进行管网流量分配，因此可以达到流量动态平衡的效果，并进而达到节约热网资源的效果。
实施例2：
一方面，如在实施例1中介绍的那样，由于其他节点的存在，将流量最有利节点的流量减小之后，也会使其他节点的流量产生不同程度的增大，因此流量最不利节点的流量并不会随之呈线性增大，即有时候单纯依靠实施例1提供的方法，有可能无法达到供暖管网的流量动态平衡的效果。
另一方面是，在上级管网对某一管网单元的整体流量分配不足的情况下，该管网单元会产生流量饥饿现象，即无论怎样调节管网单元内各节点的流量，都不可能达到供暖管网的流量动态平衡。
再一方面，在使用实施例1介绍的方法之后，管网单元内部各个节点达到的平衡为允差范围内的水力平衡，即依靠流量调节达到流量动态平衡，但是由于管网物理原因，如管网热损导致的水温衰减，单单解决水力平衡并不能达到供暖管网的温度动态平衡（即各个节点的供热效果上的平衡）。
对于供暖而言，其最终的目的是要使一个管网单元内各个节点的供暖温度都能够达到市政规定的标准温度，即达到温度的动态平衡。其中，实施例1主要是通过流量的动态平衡来达到温度的动态平衡，但由于上述三个方面的原因，在不增加管网单元整体流量分配的情况下，已经不能再通过单纯的流量调节来达到管网的温度动态平衡了。
因此，为了在不改变上一级管网运行状态下（即不改变管网单元的整体流量分配）使各个节点达到供热效果的最大化，在实施例2中，利用HeartBleeding算法（水力平衡算法）对各个节点的热工效应进行进一步计算，计算得到的数据用于使各个节点达到供热的平衡，其中单个节点热工效应为该节点的流量与温度差的乘积，温度差指的是该节点处供暖媒介的实际温度与市政规定的标准温度之间的差值。因此，为提高某一节点的热工效应，一个方法是增大该节点的流量，另一个方法是提高该节点的温度差。实施例2介绍的方法是继续增大流量。具体的方法在下面介绍。
如图2所示，本发明实施例2提供了一种供暖管网的动态平衡方法。该方法在实施例1中的步骤1-3的基础上，还包括以下步骤4：
步骤4、在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。
通过该步骤4，可以在不增加上一级管网为其分配的总流量的条件下，利用管网单元内部各个节点之间的耦合影响，将关断节点的流量补偿给其它节点，通过增加的流量提高被补偿节点的温度，以使管网单元内的各个节点达到温度动态平衡。所述的预定时间根据关断方案不同而有所不同，下面举例说明。
在一个实施方式中，所述步骤4具体可以包括：
步骤41、确定管网单元内每一节点的现实温度分布，将每个节点的现实温度与市政标准温度相比较，确定管网单元内的温度最有利节点和温度最不利节点，温度最有利节点的现实温度高于市政标准温度，温度最不利节点的现实温度低于市政标准温度；
确定管网单元内每一节点的现实温度的方法很多，较直接的方法是收集各个节点的温控器反馈的温度数据，再根据各个节点的温度数据获取该管网单元内各节点的现实温度分布。
上述市政标准温度根据市政的规定确定，例如可以是18℃，或者25℃。
在本步骤41中，确定温度最有利节点和温度最不利节点的原理与步骤2中确定流量最有利节点和流量最不利节点的原理相同，可以类推适用，此处不再赘述。
步骤41′、依次关断管网单元内的各节点，确定一个节点关断后对其它节点的流量补偿比重，选择具有特定流量补偿比重的节点作为步骤42中的所述部分节点；
由于关断温度最有利节点之后，温度最不利节点和其它节点的流量都会增大，这一步的目的就是确定温度最不利节点和其它节点流量增大的程度，该程度间接地通过流量补偿比重显示出来。在一个管网单元中，可能存在很多个节点，这样在执行下述步骤42时对管网单元的全部节点都进行操作将花费大量的时间，此步骤41′的作用就是首先进行一次预判，选择具有特定流量补偿比重的节点作为步骤42中的所述部分节点，以节省执行步骤42的时间。
本步骤中的流量补偿比重可以表征节点间的耦合程度，流量补偿比重越大表明耦合程度越大，关断与温度最有利节点耦合程度大的节点可以使流量尽可能地补偿给该温度最不利节点。因此可以选择关断后对温度最不利节点的流量补偿有显著影响的节点作为具有特定流量补偿比重的节点，该显著影响需要根据情况具体判断，例如可以将判断标准设定为只要对温度最不利节点的流量有补偿效果就视为有显著影响。
实施例2中以一个管网单元供应5户（即5个节点）为例进行说明，假设该管网单元的总流量为1t/h（1吨/时），对入户阀门进行顺序关闭，同时其他节点的阀门保持全开状态，得到的流量补偿比重如下表所示：
流量补偿比重	关断A节点	关断B节点	关断C节点	关断D节点	关断E节点
A节点	0.0	0.6	0.65	0.65	0.65
B节点	0.4	0.0	0.3	0.3	0.3
C节点	0.3	0.2	0.0	0.05	0.05
D节点	0.2	0.15	0.05	0.0	0.0
E节点	0.1	0.05	0.0	0.0	0.0
需要注意的是，上述表中的数据均为模拟数据，在实际使用中，代入真实数据即可。
例如，上述5个节点从上游至下游依次排列，在依次关断上述5个节点时，从上表可以得出关闭某一节点对管网单元内其他节点的流量变化贡献情况，具体如下： 
关断A节点时，B-E节点所占的流量补偿比重分别为：40%、30%、20%和10%；
关断B节点时，A、C-E节点所占的流量补偿比重分别为：60%、20%、15%和5%；
关断C节点时，A-B、D-E节点所占的流量补偿比重分别为：65%、30%、5%和0；
关断D节点时，A-C、E节点所占的流量补偿比重分别为：65%、30%、5%和0；
关断E节点时，A-D节点所占的流量补偿比重分别为：65%、30%、5%和0。
上述流量补偿比重是在关断节点之后，等待足够长的时间以使其它各节点的流量稳定，在流量稳定状态下收集各个节点的热表反馈的流量数据，并计算得到的。
由上述数据可知，例如以最下游的E节点作为温度最不利节点时，A、B两个节点关断对E节点的流量补偿具有影响，因此设定A、B节点为具有特定流量补偿比重的节点，在执行步骤42时，可以仅依次关断A、B节点，而不必依次关断全部节点，以节省操作时间。
这里需要说明的是，该步骤41′是可选步骤，也可以不经步骤41′而在执行完步骤41之后直接执行步骤42。
步骤42、依次关断管网单元内的全部或部分节点，确定在保证一个节点的市政标准温度的前提下该节点在预定周期内可被关断的最长时间，并确定一个节点关断后其它节点达到市政标准温度时所需的最短时间；
在不增加上一级管网为该管网单元分配的总流量的条件下，通过试验，依次关断管网单元内的全部或部分节点，在保证一个节点的市政标准温度的前提下得到该节点在预定周期内可被关断的最长时间TX，X表示各个被关断的节点。该预定周期可以选择为1小时或者其它周期。所述部分节点可以是步骤41′中所确定的具有特定流量补偿比重的节点，也可以是人为选择的部分节点。
实施例2中以一个管网单元供应5户（即5个节点，分别为A、B、C、D和E节点）为例进行说明。实际情况下，一个管网单元内的节点可能会远不止5个。在A、B、C、D、E这5个节点中，当其中一部分节点的现实温度高于市政标准温度时，可以在预定周期内将这部分节点暂时关断一段时间也不会使其现实温度降至市政标准温度以下。其余部分节点的现实温度等于或低于市政标准温度时，该其余部分节点就不可以关断，否则这些节点的现实温度就会低于市政标准温度，因此对这些节点可以不通过关断试验而将其可关断的最长时间设置为0。
通过对各个节点的现实温度和市政标准温度的对比，例如，发现A、B、C节点的现实温度高于市政标准温度，D节点的现实温度等于市政标准温度，E节点的现实温度低于市政标准温度。此时，首先设置D、E节点的可被关断的最长时间TD=0、TE=0。之后，通过试验，可以得到A、B、C节点在预定周期内可被关断的最长时间，例如此处分别假设为TA=10min、TB=5min、TC=1min。即，在一个小时内，将A节点关断10min、B节点关断5min、C节点关断1min均不会导致这三个节点的现实温度降至市政标准温度以下。
此外，依次关断管网单元内的全部或部分节点，还需要得到关断一个节点之后，其它节点在达到市政标准温度时所需的最短时间tXY，X表示各个被关断的节点，Y表示其下游节点。例如，上述5个节点从上游至下游依次排列，在依次关断上述5个节点时，得到上游节点关断影响下游节点到达市政标准温度的最短时间如下，该最短时间可以在各节点之间形成如图3所示的拓扑图，该拓扑图不考虑关断下游节点对上游节点的影响。在图3中，各节点旁边括号内的时间为所述最长时间TX，两个节点之间连线上的时间为所述最短时间tXY。
如图3所示：
关断A节点时，B节点达到市政标准温度的最短时间tAB=5min，tAC=10min，tAD=8min，tAE=15min；
关断B节点时，C节点达到市政标准温度的最短时间tBC=15min，tBD=20min，tBE=25min；
关断C节点时，D节点达到市政标准温度的最短时间tCD=25min，但经过足够长的时间E节点始终未达到市政标准温度（由步骤41′也可知，关断C节点对E节点的流量补偿为0），因此tCE=∞（无穷大）；
关断D节点时，经过足够长的时间E节点始终未达到市政标准温度（由步骤41′也可知，关断D节点对E节点的流量补偿为0），因此E节点达到市政标准温度的最短时间tDE=∞（无穷大）。
上述的最长时间TX和最短时间tXY可以在一次关断节点的操作中全部得到，也可以在两次关断节点的操作中分别得到。
与流量补偿比重类似，所述最短时间tXY也可以表征节点间的耦合程度，所述最短时间tXY越小表明耦合程度越大。关断与温度最有利节点耦合程度大的节点可以使流量尽可能地补偿给该温度最不利节点，并且可以使该温度最不利节点的现实温度得到尽可能快的提升。
步骤43、依据所述最短时间，选择包含所述温度最有利节点和温度最不利节点的耗时最短路径，并依据所述耗时最短路径确定节点关断方案，以使所述温度最不利节点达到温度动态平衡。
该耗时最短路径实质上为与温度最不利节点具有最佳耦合程度的路径，由于上述最短时间tXY可以表征耦合程度，时间越短，表明耦合程度越强。两个节点之间的耦合程度越强，说明其中一个节点关断后，对另一个节点的流量变化影响越大。因此，通常情况下，与一个节点的耦合程度最强的节点如果不是温度最不利节点的话，希望将该耦合程度最强的节点也同时关闭，以最大程度的增加温度最不利节点的流量。
在通过上述步骤41-43使当前的温度最不利节点达到温度动态平衡之后，可循环重复执行步骤41-43，使管网单元内的各个节点均达到温度动态平衡。
在该步骤43下执行HeartBleeding算法，以获得使所述温度最不利节点达到温度动态平衡的耗时最短路径。该算法具体如下：
步骤431、首先，将所述温度最有利节点纳入所述耗时最短路径中；
步骤432、接着，在所述最短时间中选择以所述温度最有利节点作为始端的最小时间路径，并将该路径纳入所述耗时最短路径中；
步骤433、之后，选择与已经纳入到所述耗时最短路径中的节点相通的、且不与已经纳入到所述耗时最短路径中的路径构成闭合回路的最小时间路径，并将该路径纳入所述耗时最短路径中；此步骤将循环执行，这样符合条件的路径将被相继添加到所述耗时最短路径中。
步骤434、当所述最不利节点被纳入到所述耗时最短路径中之后，结束选择。
确定好所述耗时最短路径之后，执行下述步骤435，以确定节点关断方案：
步骤435、在与所述耗时最短路径包含的各节点对应的所述最长时间内，同时关断相应的节点。
举例而言，当确定最上游的A节点为温度最有利节点、最下游的E节点为温度最不利节点时，依据步骤431-434介绍的方法，首先将A节点纳入所述耗时最短路径中，之后根据图3显示的拓扑图，将以A节点作为始端的最小路径AB纳入所述耗时最短路径中，之后依据同样的原理将最小路径BC纳入所述耗时最短路径中，最后纳入E节点。
依据上述耗时最短路径确定的关断方案为：首先，A、B、C三个节点同时关断1min，之后C节点打开；接着，A、B节点同时关断4min，之后B节点打开；最后，A节点再单独关断5min，之后再打开。这样，A、B、C三个节点的关断时间均未超过其对应的所述最长时间TX，并且在与各节点对应的最长时间内，同时关断相应的节点，可以最大限度的降低其他节点的耦合影响，使温度最不利节点E的流量得到最大限度的补偿，并使其现实温度得到最大限度的提升。例如，在将路径AB纳入所述耗时最短路径之后，接着纳入路径BC，而不是纳入路径BE，是因为关断B节点，使得C节点获得的流量补偿大于E节点获得的流量补偿，因此将路径BC纳入之后同时关闭C节点有利于提高E节点的流量补偿。以下给出上述算法的伪代码：
在具有N个节点的管网单元所形成的拓扑图中：
O := 耗时最短路径
For i:=1 to N – 2
开始执行
C := 与O内部的节点相通、且添加到O内部的不与已经纳入到O中的路径构成闭合回路的最小时间路径
O := 添加了C的最新的耗时最短路径
结束：i:= N -2 ，最终得到耗时最短路径。
按照以上方式最终得出：
选择							路径								耗时
  1							{A,B}								5mins
  2							{B,C}								15mins
  3							{C,E}								∞（无穷大）
综合而言，本实施例2在通过实施例1介绍的方法不能达到供暖管网的流量动态平衡、或者仅能达到流量动态平衡而无法达到温度动态平衡的前提下，并且在不增加上一级管网为其分配的总流量的条件下，利用各个节点之间的耦合影响，在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。这样不会增加管网单元的整体热消耗，节约了能源。
如图4所示，本发明实施例还提供了一种供暖管网的动态平衡系统，在所述供暖管网中一个管网单元包括多个节点，则所述系统包括：
热表401，在每个节点处设置一个热表401，热表401电连接至管网动态平衡控制器420，并用于采集对应节点的流量数据；
阀门403，在每个节点处设置一个阀门403，阀门403连接在供水管路上，并且阀门403电连接至管网动态平衡控制器420，阀门403根据管网动态平衡控制器420的指令控制自身的开度。
管网动态平衡控制器420，包括流量动态平衡控制单元421，所述流量动态平衡控制单元421与热表401和阀门403电连接，用于：确定管网单元内每一节点的现实流量分布；将每个节点的现实流量与正常流量相比较，确定管网单元内的流量最有利节点和流量最不利节点，其中，流量最有利节点的现实流量大于正常流量，流量最不利节点的现实流量小于正常流量；调节流量最有利节点和流量最不利节点的流量，使管网单元内的各个节点均达到正常流量，实现供暖管网的流量动态平衡。
其中，热表401用于监测每个节点管道的热工性能，包含：瞬时冷量，累计热量，瞬时热量，瞬时流速，累计流量，管道供水温度，管道回水温度等。本实施例中，主要利用热表401监测节点的实际瞬时流量（即现实流量）。阀门403为电动阀门，接收来自管网动态平衡控制器420的阀门开度信息，通过改变阀门403的开度实现对各节点的管道的瞬时流量调控。所述管网动态平衡控制器420与所述热表401通过RS485总线连接。管网动态平衡控制器420与热表401进行实时热功性能数据交互，并接收来自管理中心（通过网络集中交换机440衔接）发送出的额定瞬时流量信息（即正常流量），通过采集到的实际瞬时流量与额定瞬时流量进行比对，将控制结果转化为电动阀门的开度信息，从而实现对每个节点用热的动态平衡。
在图4所示的实施例中，所述系统还包括总阀门430，总阀门430与管网动态平衡控制器420电连接，用于增加或减少所述管网单元的总流量。这是在上级管网为管网单元分配的流量不足或过剩时使用的。
并且，在图4所示的实施例中，所述系统还包括网络集中交换机440，网络集中交换机440与管网动态平衡控制器420通过网络连接，接收并保存管网动态平衡控制器420控制的各节点流量数据和阀门开度数据。其中，所使用的网络可以为无线网络或有线网络。
在上述供暖管网动态平衡系统中，所述系统还包括温控器402，所述管网动态平衡控制器420还包括温度动态平衡控制单元422，温度动态平衡控制单元422与温控器402和阀门403电连接，温控器402用于采集对应节点的温度数据，温度动态平衡控制单元422用于在预定时间内，关断至少一个节点以补偿其它节点的流量，使管网单元内的各个节点达到温度动态平衡。
图5为依据图4所示的供暖管网动态平衡系统进行具体布置的示例图，在图5中，部分零部件如温控器402、流量动态平衡控制单元421、温度动态平衡控制单元422等未显示。
对所公开的实施例的上述说明，目的是使本领域专业技术人员能够实现或使用本发明。对这些实施例的多种修改对本领域的专业技术人员来说将是显而易见的，本文中所定义的一般原理可以在不脱离本发明的精神或范围的情况下，在其它实施例中实现。因此，本发明将不会被限制于本文所示的这些实施例，而是要符合与本文所公开的原理和新颖特点相一致的最宽的范围。
